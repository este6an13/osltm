## November 7th, 2025

### Summary

Ingested estimated demand data (check-ins and check-outs, λ̂ estimates at 5-minute resolution aggregated to 15-minute windows) for a stratified sample of dates into the database.
Conducted a first round of statistical validation focusing on **distributional assumptions** and **temporal consistency** across weekdays, date types, and months.
The normality hypothesis was consistently rejected for all tested stations (IDs 9, 49, 72, 103) for both inflow and outflow series, confirming the need for non-parametric analysis.

Kruskal–Wallis tests across weekdays (Mon–Fri) suggested **no significant differences** between weekdays, while tests across date types (WD, SA, SU, HO) and across months showed **significant heterogeneity**, indicating that demand intensity varies meaningfully between weekends, holidays, and months.

---

### Method and Implementation

Implemented a modular validation suite in Python using SQLAlchemy for data retrieval and `scipy.stats` for hypothesis testing.
Key steps:

1. **Data Loading:**
   Queried the `Estimate` table (station-level λ̂ values) using `_load_estimate_data()` for selected stations.

2. **Normality Tests (pooled):**
   Used multiple tests—Shapiro–Wilk, D’Agostino K², Anderson–Darling, and Kolmogorov–Smirnov—to assess distributional normality.

   * All p-values < 0.05 for tested stations (IDs 9, 49, 72, 103), both in/out series → **normality rejected**.

3. **Weekday Consistency:**
   Applied Kruskal–Wallis across Mon–Fri (date_type = WD).

   | Station | n_groups | H_stat | p_value | Interpretation                    |
   | ------- | -------- | ------ | ------- | --------------------------------- |
   | 9       | 5        | 5.42   | 0.25    | Fail to reject (weekdays similar) |
   | 49      | 5        | 2.45   | 0.65    | Fail to reject                    |
   | 72      | 5        | 2.20   | 0.70    | Fail to reject                    |
   | 103     | 5        | 8.70   | 0.07    | Marginal (but not significant)    |

   → **Weekday λ̂ patterns statistically consistent** within stations.

4. **Date-Type Differences (WD, SA, SU, HO):**
   Kruskal–Wallis tests showed **significant differences** (p < 0.05), indicating distinct λ̂ distributions across weekday/weekend/holiday categories.

5. **Sunday vs Holiday Comparison:**
   Mann–Whitney U tests revealed **statistical differences** between SU and HO λ̂ values, contradicting the initial assumption of similarity.

6. **Monthly Stability:**
   Month-to-month Kruskal–Wallis tests yielded extremely low p-values (≈10⁻⁷–10⁻²⁰), confirming **strong seasonal or structural variation** over months.

   Example results:

   | Station | n_months | H_stat | p_value |
   | ------- | -------- | ------ | ------- |
   | 9       | 12       | 69.52  | 1.5e-10 |
   | 49      | 12       | 119.65 | 2.1e-20 |
   | 72      | 12       | 51.08  | 4.0e-07 |
   | 103     | 12       | 106.28 | 1.0e-17 |

---

### Decisions

* **Use non-parametric methods** (Kruskal–Wallis, Mann–Whitney U) for all further temporal consistency checks, given pervasive non-normality.
* Treat **weekdays as a single group** in subsequent modeling, since weekday variation was not significant.
* **Keep SU and HO separate** for modeling and aggregation, as they differ statistically.
* Consider **monthly or seasonal covariates** in subsequent intensity models to capture temporal drift.

---

### Assumptions to Validate

1. Validate whether λ̂ variations across months are driven by **seasonal demand** or **sampling bias** (stratified dates).
2. Assess **station-level heterogeneity** in weekday vs weekend effects across the full network.
3. Explore whether the λ̂ non-normality is structural (intrinsic to Poisson nature) or due to **estimation noise / truncation**.
