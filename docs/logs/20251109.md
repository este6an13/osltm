## November 9th, 2025

### Summary

Initial evaluation of **Poisson vs Negative Binomial (Local)** simulation performance across multiple stations and date types. Despite evidence of overdispersion in the data (variance > mean in most time windows), the **Poisson model achieved higher R² scores** overall compared to the Negative Binomial (NB) approach. Performance was assessed by comparing simulated flows against actual observed λ-curves on selected comparison dates.

### Method and Implementation

* Implemented the function `simulate_average_station_flows()` with support for both Poisson and Negative Binomial (“NB-local” and “NB-global”) distributions.
* Simulations were based on averaged λ values per 15-minute interval, derived from historical estimates within a configurable date range (filtered by `start_date` and `end_date`).
* Dispersion (`r`) for the NB-local approach was estimated per time interval using the method of moments:
  [
  r = \frac{\mu^2}{\text{Var} - \mu}
  ]
* Only time windows between **04:00 and 23:00** were included to standardize series length.
* Performance was evaluated with **MAE**, **RMSE**, **MAPE**, and **R²**, comparing simulated series vs actual λ on the chosen date.

### Decisions

* Selected the **Negative Binomial (Local)** approach as the conceptually correct model.
* Model each (station, date type, time window) combination as a distinct process that may exhibit different dispersion behavior.
* Despite this, results showed consistently **higher R² values for Poisson**, suggesting potential issues in dispersion estimation or overfitting.
* Retained per-interval dispersion reporting to monitor the proportion of overdispersed vs Poisson-like intervals.

### Assumptions to Validate

* The current **method-of-moments** dispersion estimation per interval is stable enough despite limited daily samples.
* Overdispersion observed empirically (Var/Mean > 1) translates into meaningful improvement when simulated via NB.
* Differences in R² might reflect instability in small λ values or artifacts of the random sampling rather than model inadequacy.
* Need to verify whether a **hierarchical or smoothed** dispersion estimation (e.g., rolling or Bayesian shrinkage) improves the NB model’s consistency.
